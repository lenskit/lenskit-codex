schema: '2.0'
stages:
  import-ml-32m:
    cmd: python ../import-ml.py ml-32m.zip
    deps:
    - path: ../import-ml.py
      hash: md5
      md5: 30e3b5d3d15e7797637601877711c1ba
      size: 3648
    - path: ../ml-stats.sql
      hash: md5
      md5: b016dc983a2156e0712a846097a968e7
      size: 1307
    - path: ml-32m.zip
      hash: md5
      md5: d472be332d4daa821edc399621853b57
      size: 238950008
    outs:
    - path: ratings.duckdb
      hash: md5
      md5: bb6c15fab0f9f49d334babc97b3b3ef6
      size: 381693952
  import:
    cmd: lenskit-codex movielens import --stat-sql=../ml-stats.sql ml-32m.zip
    deps:
    - path: ../ml-stats.sql
      hash: md5
      md5: b016dc983a2156e0712a846097a968e7
      size: 1307
    - path: ml-32m.zip
      hash: md5
      md5: d472be332d4daa821edc399621853b57
      size: 238950008
    outs:
    - path: ratings.duckdb
      hash: md5
      md5: a81c61d4b9ee0568294bdec12ad5a7de
      size: 383004672
  split-random:
    cmd: lenskit-codex split random.toml
    deps:
    - path: ../ratings.duckdb
      hash: md5
      md5: a81c61d4b9ee0568294bdec12ad5a7de
      size: 383004672
    - path: random.toml
      hash: md5
      md5: 276ffa520abcf2243c9ffee115774a98
      size: 137
    params:
      ../../../config.toml:
        random.seed: 20240717
    outs:
    - path: random.duckdb
      hash: md5
      md5: 28811d3c9cca0f3d1606042b4b5321e9
      size: 5517312
